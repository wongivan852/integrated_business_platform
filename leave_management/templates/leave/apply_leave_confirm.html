{% extends "leave/base.html" %}
{% block content %}
<h2>{% if is_revision %}Confirm Revised Application{% else %}Confirm Leave Application{% endif %}</h2>

<!-- Navigation -->
<div style="margin-bottom: 20px;">
    <a href="{% url 'leave:dashboard' %}">‚Üê Back to Dashboard</a> |
    <a href="{% url 'leave:leave_applications' %}">View My Applications</a>
</div>

{% if is_revision %}
<div style="background: #e8f4fd; border: 1px solid #b8daff; padding: 15px; margin-bottom: 20px; border-radius: 3px; color: #0c5460;">
    <strong>Revising Leave Application</strong><br>
    Please review your changes below. Once confirmed, your revised application will remain pending for manager approval.
</div>
{% endif %}

<!-- Confirmation Details -->
<div style="background: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 20px;">
    <h3 style="color: #2c3e50; margin-top: 0;">Application Summary</h3>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
        <div>
            <strong>Employee:</strong><br>
            {{ employee.user.get_full_name }} ({{ employee.get_region_display }})
        </div>
        <div>
            <strong>Leave Type:</strong><br>
            {{ leave_type.name }}
        </div>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
        <div>
            <strong>Start:</strong><br>
            {{ start_date_display }} at {{ start_time_display }}
        </div>
        <div>
            <strong>End:</strong><br>
            {{ end_date_display }} at {{ end_time_display }}
        </div>
    </div>
    
    <div style="margin-bottom: 15px;">
        <strong>Total Duration:</strong><br>
        <span style="font-size: 18px; color: #e74c3c; font-weight: bold;">{{ application_data.days_applied }} 
        {% if application_data.days_applied <= 1 %}day{% else %}days{% endif %}</span>
        {% if application_data.includes_saturday_work %}
            <br><small style="color: #856404;">
                ({{ business_days }} business days + {{ application_data.saturday_work_days }} Saturday working days)
            </small>
        {% endif %}
    </div>
    
    {% if application_data.reason %}
    <div style="margin-bottom: 15px;">
        <strong>Reason:</strong><br>
        <div style="background: white; padding: 10px; border-radius: 3px; border: 1px solid #ddd;">
            {{ application_data.reason }}
        </div>
    </div>
    {% endif %}
    
    <!-- Saturday Working Day Warning -->
    {% if application_data.saturday_warning %}
    <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
        <div style="color: #856404; font-weight: bold;">
            ‚ö†Ô∏è Saturday as Working Day Notice
        </div>
        <div style="color: #856404; margin-top: 5px;">
            {{ application_data.saturday_warning }}
        </div>
    </div>
    {% endif %}
</div>

<!-- Important Notice -->
<div style="background: #e8f4fd; border: 1px solid #bee5eb; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
    <div style="color: #0c5460; font-weight: bold;">
        üìã Please Review Carefully
    </div>
    <div style="color: #0c5460; margin-top: 5px;">
        {% if is_revision %}
            Once confirmed, your revised leave application will update the existing application and remain pending for manager approval.
        {% else %}
            Once confirmed, your leave application will be submitted for manager approval. 
            You can view the status of your application in the dashboard.
        {% endif %}
    </div>
</div>

<!-- Action Buttons -->
<form method="post" style="margin-bottom: 20px;">
    {% csrf_token %}
    <div style="display: flex; gap: 15px;">
        <button type="submit" name="confirm" style="
            background: #28a745; 
            color: white; 
            padding: 12px 25px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px;
            font-weight: bold;
        ">
            {% if is_revision %}‚úì Confirm & Update Application{% else %}‚úì Confirm & Submit Application{% endif %}
        </button>
        
        <button type="submit" name="edit" style="
            background: #ffc107; 
            color: #212529; 
            padding: 12px 25px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px;
            font-weight: bold;
        ">
            ‚úèÔ∏è Edit Application
        </button>
        
        <a href="{% url 'leave:dashboard' %}" style="
            background: #6c757d; 
            color: white; 
            padding: 12px 25px; 
            text-decoration: none; 
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            display: inline-block;
        ">
            ‚úï Cancel
        </a>
    </div>
</form>

<!-- Additional Information -->
<div style="background: #f8f9fa; padding: 15px; border-radius: 5px; color: #6c757d; font-size: 14px;">
    <strong>Next Steps:</strong>
    <ul>
        <li>Your application will be sent to your manager for approval</li>
        <li>You will receive notification when the status changes</li>
        <li>You can track your application status in the dashboard</li>
        <li>Approved leave will be automatically deducted from your leave balance</li>
    </ul>
</div>

{% endblock %}
